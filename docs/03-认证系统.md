# 认证系统

## 双模式认证

### 普通用户
- 方式1：邮箱 + 密码
- 方式2：邮箱 + 验证码

### 管理员
- 唯一方式：邮箱 + 验证码
- 首次登录自动创建账户
- 在 `config.json` 配置管理员邮箱

## JWT Token 机制

```python
# 核心代码：backend/utils/auth.py
def create_access_token(data: Dict) -> str:
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(days=7)
    to_encode.update({"exp": expire})
    return jwt.encode(to_encode, SECRET_KEY, algorithm="HS256")
```

**特性**：
- 算法：HS256
- 有效期：7天（可配置）
- 存储：localStorage (`authToken`)

## 验证码机制

**生成**：6位数字（100000-999999）
**有效期**：5分钟
**限制**：3次验证尝试
**限流**：多层防护（1分钟/1小时/1天）

```python
def generate_verification_code() -> str:
    return str(random.randint(100000, 999999))
```
